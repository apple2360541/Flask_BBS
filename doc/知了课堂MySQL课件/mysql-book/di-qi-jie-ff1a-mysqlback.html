<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>第七节：mysqlback | SQL使用</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./di-ba-jie-ff1a-mysqlslave-xstrabackup.html" />
    
    
    <link rel="prev" href="./di-liu-jie-ff1a-mysql-biao-de-guan-xi.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="7"
        data-chapter-title="第七节：mysqlback"
        data-filepath="di-qi-jie-ff1a-mysqlback.md"
        data-basepath="."
        data-revision="Wed May 30 2018 12:21:12 GMT+0800 (中国标准时间)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="chapter1.html">
            
                
                    <a href="./chapter1.html">
                
                        <i class="fa fa-check"></i>
                        
                        MySQL教程
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="di-yi-jie-ff1a-mysql-ru-men.html">
            
                
                    <a href="./di-yi-jie-ff1a-mysql-ru-men.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        第一节：MySQL入门
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        第二节：SQL使用
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="di-san-jie-ff1a-mysql-de-gai-nian-yi-ji-mysql-jia-gou-fen-xi.html">
            
                
                    <a href="./di-san-jie-ff1a-mysql-de-gai-nian-yi-ji-mysql-jia-gou-fen-xi.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        第三节：mysql的概念以及mysql架构分析
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="di-si-jie-ff1a-mysql-ri-zhi-guan-li.html">
            
                
                    <a href="./di-si-jie-ff1a-mysql-ri-zhi-guan-li.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        第四节：mysql日志管理
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="di-wu-jie-ff1a-mysql-biao-yue-shu.html">
            
                
                    <a href="./di-wu-jie-ff1a-mysql-biao-yue-shu.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        第五节：MySQL表约束
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="di-liu-jie-ff1a-mysql-biao-de-guan-xi.html">
            
                
                    <a href="./di-liu-jie-ff1a-mysql-biao-de-guan-xi.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        第六节：MySQL表的关系
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="7" data-path="di-qi-jie-ff1a-mysqlback.html">
            
                
                    <a href="./di-qi-jie-ff1a-mysqlback.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        第七节：mysqlback
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="di-ba-jie-ff1a-mysqlslave-xstrabackup.html">
            
                
                    <a href="./di-ba-jie-ff1a-mysqlslave-xstrabackup.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        第八节：mysqlslave--xstrabackup
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >SQL使用</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="mysql&#x5907;&#x4EFD;&#x548C;&#x5907;&#x4EFD;">MySQL&#x5907;&#x4EFD;&#x548C;&#x5907;&#x4EFD;</h1>
<h2 id="&#x5907;&#x4EFD;&#x8FD8;&#x539F;">&#x5907;&#x4EFD;/&#x8FD8;&#x539F;:</h2>
<ol>
<li>&#x51B7;&#x5907;&#xFF1A;&#x9700;&#x8981;&#x505C;&#x6B62;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x8FD0;&#x884C;mysqld,&#x7136;&#x540E;&#x76F4;&#x63A5;&#x62F7;&#x8D1D;&#x6216;&#x6253;&#x5305;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x3002;</li>
<li>&#x534A;&#x70ED;&#x5907;&#xFF1A;mysqldump&#xFF0B;binlog &#xFF0D;&#xFF0D;&#x9002;&#x5408;&#x6570;&#x636E;&#x91CF;&#x6BD4;&#x8F83;&#x5C0F;&#x7684;&#x5E94;&#x7528;  </li>
<li>&#x5728;&#x7EBF;&#x70ED;&#x5907;&#xFF1A;AB&#x590D;&#x5236; &#xFF0D;&#xFF0D;&#x5B9E;&#x65F6;&#x5907;&#x4EFD;  </li>
</ol>
<h3 id="&#x7B2C;&#x4E00;&#x79CD;&#x51B7;&#x5907;&#xFF08;&#x7269;&#x7406;&#x5907;&#x4EFD;&#xFF09;">&#x7B2C;&#x4E00;&#x79CD;&#x51B7;&#x5907;&#xFF08;&#x7269;&#x7406;&#x5907;&#x4EFD;&#xFF09;</h3>
<ol>
<li>&#x505C;&#x6389;mysql&#x670D;&#x52A1;&#x5668;</li>
<li>&#x62F7;&#x8D1D;&#x6570;&#x636E;<pre><code class="lang-shell">cd /data
tar cjvf /tmp/mysql_bak.tar.bz2 ./
</code></pre>
</li>
<li>&#x6D4B;&#x8BD5;&#x8FD8;&#x539F;&#xFF08;&#x53EA;&#x9700;&#x8981;&#x628A;&#x539F;&#x6765;&#x5907;&#x4EFD;&#x7684;&#x6587;&#x4EF6;&#x62F7;&#x8D1D;&#x56DE;&#x6765;&#x5373;&#x53EF;&#xFF09;&#x3002;</li>
</ol>
<h2 id="&#x7B2C;&#x4E8C;&#x79CD;&#x903B;&#x8F91;&#x5907;&#x4EFD;mysqldump">&#x7B2C;&#x4E8C;&#x79CD;&#x903B;&#x8F91;&#x5907;&#x4EFD;mysqldump</h2>
<p>mysqld&#x5FC5;&#x987B;&#x662F;&#x8FD0;&#x884C;&#x7740;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x505C;&#x6389;mysql&#x670D;&#x52A1;,&#x4F46;&#x9700;&#x8981;&#x9501;&#x8868;&#x3002;
&#x903B;&#x8F91;&#x5907;&#x4EFD;&#xFF1D;&#x8868;&#x7ED3;&#x6784;&#xFF0B;&#x6570;&#x636E;&#xFF08;&#x63D2;&#x5165;&#xFF09;</p>
<p>mysqldump&#xFF1A;</p>
<ol>
<li>&#x5907;&#x4EFD;&#x4E00;&#x5F20;&#x8868;&#x6216;&#x591A;&#x5F20;&#x8868;</li>
<li>&#x5907;&#x4EFD;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5E93;</li>
<li>&#x5907;&#x4EFD;&#x6240;&#x6709;&#x7684;&#x5E93;<pre><code>Usage: mysqldump [OPTIONS] database [tables]
OR mysqldump [OPTIONS] --databases [OPTIONS] DB1 [DB2 DB3...]
OR mysqldump [OPTIONS] --all-databases [OPTIONS]
</code></pre></li>
</ol>
<pre><code class="lang-shell"># mysqldump -uroot -p456 test t1 t2&gt; /tmp/t1.sql        --&#x5907;&#x4EFD;&#x5355;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x8868;
# mysql -uroot -p123 test &lt; /var/tmp/test_t1.sql            &#x8FD8;&#x539F;test&#x5E93;&#x7684;t1,t2&#x8868;

# mysqldump -uroot -p456 --databases test test1 test2 &gt; /tmp/test.sql --&#x5907;&#x4EFD;&#x591A;&#x4E2A;&#x5E93;   

# mysqldump -uroot -p456 --all-databases &gt; /tmp/all.sql --&#x5907;&#x4EFD;&#x6240;&#x6709;&#x5E93;

&#x8FD8;&#x539F;:  
&#x8FD8;&#x539F;&#x4E00;&#x4E2A;&#x8868;:  
mysql&gt; use test;
mysql&gt; drop table t1;
# mysql -uroot -p456 test &lt; /tmp/t1.sql 
# mysql -uroot -p456 -e &quot;use test; show tables;&quot; 

+----------------+  
| Tables_in_test |  
+----------------+  
| imptest |  
| t1 |  
+----------------+  

&#x8FD8;&#x539F;&#x4E00;&#x4E2A;&#x5E93;:  
mysql&gt; drop database test;

# mysql -uroot -p456  -e &quot;create database test;&quot;
# mysql -uroot -p456 test &lt; /tmp/test.sql 
# mysql -uroot -p456 -e &quot;show databases;&quot;

+--------------------+  
| Database |  
+--------------------+  
| information_schema |  
| mysql |  
| test |  

## +--------------------+
</code></pre>
<p>mysqldump --&#x5728;&#x7EBF;&#x5907;&#x4EFD;&#xFF0C;&#x9700;&#x8981;&#x9501;&#x8868;&#xFF0C;&#x6548;&#x7387;&#x4F4E;&#x3002;&#x53EA;&#x80FD;&#x5907;&#x4EFD;&#x67D0;&#x4E2A;&#x65F6;&#x523B;&#x6570;&#x636E;&#x72B6;&#x6001;.</p>
<pre><code class="lang-shell"># mysqldump -uroot -p147258369 DB &gt; /tmp/DB.sql     --&#x5355;&#x5E93;
# mysqldump -uroot -p147258369 DB t1 &gt; /tmp/DB.t1.sql   --&#x5355;&#x8868;
# mysqldump -uroot -p147258369 --all-databases &gt; /tmp/all.sql   --&#x5168;&#x5E93;
</code></pre>
<p>&#x6062;&#x590D;:</p>
<pre><code># mysql -uroot -p123 &lt; /tmp/all.sql
</code></pre><h2 id="&#x7B2C;&#x4E09;&#x79CD;&#x589E;&#x91CF;&#x6570;&#x636E;&#xFF1A;">&#x7B2C;&#x4E09;&#x79CD;&#x589E;&#x91CF;&#x6570;&#x636E;&#xFF1A;</h2>
<p>binlog --&#x8BB0;&#x5F55;&#x7740;mysql&#x670D;&#x52A1;&#x5668;&#x589E;&#x5220;&#x6539;&#x7684;&#x64CD;&#x4F5C;&#x8BB0;&#x5F55;.
mysqlbinlog
--start-datetime=name &#x5F00;&#x59CB;&#x7684;&#x65F6;&#x95F4;
--stop-datetime=name &#x7ED3;&#x675F;&#x7684;&#x65F6;&#x95F4;
--start-position=# &#x5F00;&#x59CB;&#x7684;&#x4F4D;&#x7F6E;(POS)
--stop-position=# &#x7ED3;&#x675F;&#x7684;&#x4F4D;&#x7F6E;</p>
<pre><code>mysql&gt; flush logs;

# mysqlbinlog --start-position=190 --stop-position=833 mysqld.000001|mysql -uroot -p147258369  

# mysqlbinlog --start-position=1554 --stop-datetime=&quot;2011-09-02 11:48:10&quot; mysqld.000001 | mysql -uroot -p147258369  

## 106-280
</code></pre><p>&#x5907;&#x4EFD;&#x65B9;&#x6848;1&#xFF1A;
&#x5B8C;&#x5168;&#x5907;&#x4EFD;(mysqldump)+&#x589E;&#x91CF;&#x5907;&#x4EFD;(binlog)</p>
<ol>
<li>&#x6570;&#x636E;&#x603B;&#x91CF;&#x4E0D;&#x5927;&#xFF0C;&#x4E00;&#x822C;&#x5728;&#x51E0;&#x767E;M&#x7684;&#x6570;&#x636E;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;</li>
<li>&#x5982;&#x679C;&#x6570;&#x636E;&#x91CF;&#x5927;&#x592A;&#xFF0C;&#x6BCF;&#x6B21;&#x5907;&#x4EFD;&#x9501;&#x8868;&#x7684;&#x65F6;&#x95F4;&#x4F1A;&#x6BD4;&#x8F83;&#x957F;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x80FD;&#x5F71;&#x54CD;&#x4E0A;&#x5C42;&#x5E94;&#x7528;&#x6B63;&#x5E38;&#x4F7F;&#x7528;.</li>
</ol>
<p>&#x5907;&#x4EFD;&#xFF1A;</p>
<pre><code># mysqldump -uroot -p147258369 --flush-logs --master-data=2 --all-databases &gt; /tmp/all2.sql
    --flush-logs        --&#x5907;&#x4EFD;&#x65F6;&#x5148;&#x5185;&#x5B58;&#x4E2D;&#x65E5;&#x5FD7;&#x5199;&#x5165;&#x56DE;&#x78C1;&#x76D8;&#xFF0C;&#x7136;&#x540E;&#x622A;&#x65AD;&#x65E5;&#x5FD7;,&#x5E76;&#x4EA7;&#x751F;&#x65B0;&#x7684;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;
    --master-data=2 --&#x8FDB;&#x884C;&#x5168;&#x5E93;&#x9501;&#x8868;&#xFF0C;&#x5E76;&#x8BB0;&#x5F55;&#x5F53;&#x524D;all2.sql,&#x5BF9;&#x5E94;&#x7684;binlog&#x6587;&#x4EF6;&#x540D;&#x53EB;&#x4EC0;&#x4E48;
</code></pre><p>&#x67E5;&#x770B;&#x5B8C;&#x6574;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5B57;&#x6BB5;</p>
<pre><code># vim /tmp/all2.sql  
-- CHANGE MASTER TO MASTER_LOG_FILE=&apos;mysqld.000002&apos;, MASTER_LOG_POS=106;
</code></pre><p>&#x8FD8;&#x539F;  </p>
<pre><code># mysql -uroot -p147258369 &lt; /tmp/all2.sql
# mysqlbinlog --start-position=106 --stop-datetime=&quot;2011-09-02 14:00:20&quot; mysqld.000002 | mysql -uroot -p147258369
</code></pre><p>&#x4F7F;&#x7528;&#x811A;&#x672C;&#x5907;&#x4EFD;:  </p>
<pre><code># vim mysql_backup.sh 
#!/bin/bash

name=`date +%Y%m%d-%T`

/usr/bin/mysqldump -uroot -p147258369 --flush-logs --master-data=2 --all-databases &gt; /tmp/$name.sql

crontab -e  &#x8BBE;&#x7F6E;&#x7B2C;&#x5929;5&#x70B9;&#x949F;&#x505A;&#x5907;&#x4EFD;
00 05 * * * /bin/sh /var/ftp/notes/scripts/mysql_backup.sh &amp;&gt; /dev/null
</code></pre><h2 id="ab&#x590D;&#x5236;-&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5728;&#x7EBF;&#x5907;&#x4EFD;">AB&#x590D;&#x5236; --&#x4E3B;&#x4ECE;&#x590D;&#x5236;,&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5728;&#x7EBF;&#x5907;&#x4EFD;.</h2>
<ol>
<li>mysql &#x590D;&#x5236;&#x4ECB;&#x7ECD;
&#x5C06;&#x67D0;&#x4E00;&#x53F0;&#x4E3B;&#x673A;&#x4E0A;&#x7684; Mysql &#x6570;&#x636E;&#x590D;&#x5236;&#x5230;&#x5176;&#x5B83;&#x4E3B;&#x673A;(slaves)&#x4E0A;&#xFF0C;&#x5E76;&#x91CD;&#x65B0;&#x6267;&#x884C;&#x4E00;&#x904D;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x5F53;&#x524D;&#x4E3B;&#x673A;&#x4E0A;&#x7684; mysql&#x6570;&#x636E;&#x4E0E;(master)&#x4E3B;&#x673A;&#x4E0A;&#x6570;&#x636E;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x7684;&#x8FC7;&#x7A0B;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x79F0;&#x4E3A;&#x590D;&#x5236;&#x3002;&#x590D;&#x5236;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x5145;&#x5F53;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x800C;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5176;&#x5B83;&#x670D;&#x52A1;&#x5668;&#x5145;&#x5F53;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x3002;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x5C06;&#x66F4;&#x65B0;&#x5199;&#x5165;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x7EF4;&#x62A4;&#x6587;&#x4EF6;&#x7684;&#x4E00;&#x4E2A;&#x7D22;&#x5F15;&#x4EE5;&#x8DDF;&#x8E2A;&#x65E5;&#x5FD7;&#x5FAA;&#x73AF;&#x3002;&#x8FD9;&#x4E9B;&#x65E5;&#x5FD7;&#x53EF;&#x4EE5;&#x8BB0;&#x5F55;&#x53D1;&#x9001;&#x5230;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x7684;&#x66F4;&#x65B0;&#x3002;&#x5F53;&#x4E00;&#x4E2A;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x8FDE;&#x63A5;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x65F6;&#xFF0C;&#x5B83;&#x901A;&#x77E5;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x5728;&#x65E5;&#x5FD7;&#x4E2D;&#x8BFB;&#x53D6;&#x7684;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x6210;&#x529F;&#x66F4;&#x65B0;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x63A5;&#x6536;&#x4ECE;&#x90A3;&#x65F6;&#x8D77;&#x53D1;&#x751F;&#x7684;&#x4EFB;&#x4F55;&#x66F4;&#x65B0;&#xFF0C;&#x7136;&#x540E;&#x5C01;&#x9501;&#x5E76;&#x7B49;&#x5F85;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x901A;&#x77E5;&#x65B0;&#x7684;&#x66F4;&#x65B0;&#x3002;</li>
<li><p>mysql&#x590D;&#x5236;&#x80FD;&#x89E3;&#x51B3;&#x4EC0;&#x4E48;&#x95EE;&#x9898;</p>
<ul>
<li>&#x6570;&#x636E;&#x7684;&#x5206;&#x5E03;(data Distribution)</li>
<li>&#x8D1F;&#x8F7D;&#x5747;&#x8861;| mysql &#x8BFB;&#x5199;&#x5206;&#x79BB;</li>
<li>&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x6570;&#x636E;&#x7684;&#x5907;&#x4EFD;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x80FD;&#x5F53;&#x771F;&#x6B63;&#x610F;&#x4E49;&#x4E0A;&#x6570;&#x636E;&#x5907;&#x4EFD;&#x6765;&#x7528;</li>
<li>&#x9AD8;&#x53EF;&#x7528;&#x6027;&#x548C;&#x5BB9;&#x9519;&#x6027;(&#x6BD4;&#x5982;&#x53CC;&#x4E3B;&#x6A21;&#x5F0F;&#x4E2D;&#x7684;&#x4E92;&#x4E3A;&#x4E3B;&#x4ECE;&#x80FD;&#x5B9E;&#x73B0;&#x9AD8;&#x53EF;&#x7528;)</li>
</ul>
</li>
<li><p>mysql&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x539F;&#x7406;</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7342323-a2476ac47cb73db2.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/506" alt=""></p>
</li>
<li><p>&#x6B65;&#x9AA4;</p>
<ul>
<li>&#x5728;Master&#x670D;&#x52A1;&#x5668;&#x5C06;&#x6539;&#x53D8;&#x7684;&#x6570;&#x636E;&#x8BB0;&#x5F55;&#x5230;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;(binary log)&#x4E2D;(&#x8FD9;&#x4E9B;&#x8BB0;&#x5F55;&#x53EB;&#x505A;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x4E8B;&#x4EF6;)</li>
<li>Slave &#x670D;&#x52A1;&#x5668;&#x5C06; Master &#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x62F7;&#x8D1D;&#x5230;&#x81EA;&#x5DF1;&#x7684;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;(relay-log)&#x4E2D;</li>
<li>Slave &#x670D;&#x52A1;&#x5668;&#x8BFB;&#x53D6;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x4E2D;&#x7684;&#x4E8B;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6539;&#x53D8;&#x7684;&#x6570;&#x636E;&#x5199;&#x5165;&#x5230;&#x81EA;&#x5DF1;&#x7684;&#x6570;&#x636E;&#x5E93;&#x4E2D;</li>
</ul>
</li>
<li><p>&#x6D41;&#x7A0B;</p>
<ul>
<li>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x662F;&#x5728; Master &#x670D;&#x52A1;&#x5668;&#x4E0A;&#x8BB0;&#x5F55;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x3002;&#x5728;&#x6BCF;&#x4E2A;&#x66F4;&#x65B0;&#x6570;&#x636E;&#x7684;&#x4E8B;&#x52A1;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#xFF0C;Master &#x670D;&#x52A1;&#x5668;&#x90FD;&#x4F1A;&#x5C06;&#x6570;&#x636E;&#x66F4;&#x6539;&#x8BB0;&#x5F55;&#x5230;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x4E2D;&#x3002;&#x5373;&#x4F7F;&#x4E8B;&#x52A1;&#x5728;&#x6267;&#x884C;&#x671F;&#x95F4;&#x662F;&#x4EA4;&#x9519;&#x7684;&#xFF0C;Mysql &#x4E5F;&#x4F1A;&#x4E32;&#x884C;&#x5730;&#x5C06;&#x4E8B;&#x52A1;&#x5199;&#x5165;&#x5230;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x4E2D;&#x3002;&#x5728;&#x628A;&#x4E8B;&#x4EF6;&#x5199;&#x5165;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x4E4B;&#x540E;&#xFF0C;Master &#x670D;&#x52A1;&#x5668;&#x544A;&#x8BC9;&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x53EF;&#x4EE5;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x4E86;</li>
<li>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x662F; Slave &#x670D;&#x52A1;&#x5668;&#x628A;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x62F7;&#x8D1D;&#x5230;&#x81EA;&#x5DF1;&#x7684;&#x786C;&#x76D8;&#x4E0A;&#xFF0C;&#x8FDB;&#x5165;&#x6240;&#x8C13;&#x7684;&#x201C;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x201D;&#x4E2D;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x5B83;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#xFF0C;&#x53EB; I/O &#x7EBF;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E2A; I/O &#x7EBF;&#x7A0B;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#xFF0C;&#x7136;&#x540E;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x8F6C;&#x50A8;&#x8FDB;&#x7A0B;&#xFF08;&#x5B83;&#x6CA1;&#x6709;&#x76F8;&#x5E94;&#x7684; SQL &#x547D;&#x4EE4;&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x8F6C;&#x50A8;&#x8FDB;&#x7A0B; Master &#x670D;&#x52A1;&#x5668;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x3002;&#x5B83;&#x4E0D;&#x4F1A;&#x5BF9;&#x4E8B;&#x4EF6;&#x8FDB;&#x884C;&#x8F6E;&#x8BE2;&#x3002;&#x5982;&#x679C; 3 &#x8DDF;&#x4E0A;&#x4E86; Master &#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5C31;&#x4F1A;&#x8FDB;&#x5165;&#x4F11;&#x7720;&#x72B6;&#x6001;&#x5E76;&#x7B49;&#x5F85;&#x6709;&#x65B0;&#x7684;&#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#x65F6; Master &#x670D;&#x52A1;&#x5668;&#x53D1;&#x51FA;&#x7684;&#x4FE1;&#x53F7;&#x3002;I/O &#x7EBF;&#x7A0B;&#x628A;&#x6570;&#x636E;&#x5199;&#x5165; Slave &#x670D;&#x52A1;&#x5668;&#x7684;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x4E2D;</li>
<li>&#x7B2C;&#x4E09;&#x6B65;&#xFF1A; 107 SQL &#x7EBF;&#x7A0B;&#x8BFB;&#x53D6;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#xFF0C;&#x5E76;&#x4E14;&#x91CD;&#x653E;&#x5176;&#x4E2D;&#x7684;&#x4E8B;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x66F4;&#x65B0; Slave &#x670D;&#x52A1;&#x5668;&#x7684;&#x6570;&#x636E;&#x3002;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x80FD;&#x8DDF;&#x4E0A; I/O &#x7EBF;&#x7A0B;&#xFF0C;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x901A;&#x5E38;&#x5728;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x7F13;&#x5B58;&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x7684;&#x5F00;&#x9500;&#x5F88;&#x4F4E;&#x3002;SQL &#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x4E8B;&#x4EF6;&#x4E5F;&#x53EF;&#x4EE5;&#x88AB;&#x5199;&#x5165; Slave&#x670D;&#x52A1;&#x5668;&#x81EA;&#x5DF1;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x4E2D;&#xFF0C;&#x5B83;&#x5BF9;&#x4E8E;&#x6709;&#x4E9B;&#x573A;&#x666F;&#x5F88;&#x5B9E;&#x7528;&#x4E0A;&#x56FE;&#x4E2D;&#x663E;&#x793A;&#x4E86;&#x5728; Slave &#x670D;&#x52A1;&#x5668;&#x6709;&#x4E24;&#x4E2A;&#x8FD0;&#x884C;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x5728; Master&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x4E5F;&#x6709;&#x4E00;&#x4E2A;&#x8FD0;&#x884C;&#x7684;&#x7EBF;&#x7A0B;&#xFF1A;&#x548C;&#x5176;&#x4ED6;&#x666E;&#x901A;&#x8FDE;&#x63A5;&#x4E00;&#x6837;&#xFF0C;&#x7531; Slave &#x670D;&#x52A1;&#x5668;&#x53D1;&#x8D77;&#x7684;&#x8FDE;&#x63A5;&#xFF0C;&#x5728; Master &#x670D;&#x52A1;&#x5668;&#x4E0A;&#x540C;&#x6837;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x3002;</li>
</ul>
</li>
</ol>
<pre><code>master--&gt;slave1--slave2  
-6-&gt;slave3  

master(binlog)--&gt;slave  
192.168.0.123 192.168.0.254
</code></pre><p>1&#x3001;&#x4E3B;&#x4ECE;&#x673A;&#x5668;&#x4F7F;&#x7528;&#x7684;mysql&#x7248;&#x672C;&#x6700;&#x597D;&#x4E00;&#x81F4;&#x3002;
2&#x3001;&#x5728;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x5FC5;&#x987B;&#x542F;&#x7528;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#xFF0C;&#x5E76;&#x4E14;server-id&#x7684;&#x53D6;&#x503C;&#x8981;&#x5927;&#x4E8E;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x3002;
3&#x3001;&#x5728;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x540C;&#x6B65;binlog&#x7684;&#x8D26;&#x53F7;&#x3002;
4&#x3001;&#x5728;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x5BFC;&#x51FA;&#x539F;&#x59CB;&#x6570;&#x636E;&#x5230;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x3002;
5&#x3001;&#x5728;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x6307;&#x5B9A;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x6307;&#x5B9A;&#x8D26;&#x53F7;&#x3001;binlog&#x540D;&#x79F0;&#x3001;binlog&#x7684;&#x8D77;&#x59CB;&#x4F4D;&#x7F6E;(&#x504F;&#x79FB;&#x91CF;)&#x3002;</p>
<p>&#x5E38;&#x7528;&#x7684;&#x547D;&#x4EE4;:</p>
<pre><code>start slave
stop slave

STOP SLAVE IO_THREAD ;
STOP SLAVE SQL_THREAD;
--&gt;
Slave_IO_Running: Yes
Slave_SQL_Running: No
</code></pre><p>&#x5728;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x542F;&#x7528;binlog:</p>
<pre><code>vim /etc/my.cnf
log-slave-updates
log-bin
</code></pre><p>&#x94FE;&#x5F0F;&#x590D;&#x5236;
A -&gt; B -&gt; C
&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;A&#x4E3A;&#x4ECE;&#x670D;&#x52A1;&#x5668;B&#x7684;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#xFF0C;B&#x4E3A;&#x4ECE;&#x670D;&#x52A1;&#x5668;C&#x7684;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x3002;&#x4E3A;&#x4E86;&#x80FD;&#x5DE5;&#x4F5C;&#xFF0C;B&#x5FC5;&#x987B;&#x65E2;&#x4E3A;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x53C8;&#x4E3A;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x3002;&#x4F60;&#x5FC5;&#x987B;&#x7528;--logs-bin&#x542F;&#x52A8;A&#x548C;B&#x4EE5;&#x542F;&#x7528;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#xFF0C;&#x5E76;&#x4E14;&#x7528;--logs-slave-updates&#x9009;&#x9879;&#x542F;&#x52A8;B&#x3002;</p>
<p>C&#x5C06;B&#x5F53;&#x6210;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x6765;&#x64CD;&#x4F5C;</p>
<p>&#x5EF6;&#x8FDF;&#x590D;&#x5236;&#xFF08;&#x53EA;&#x5F00;IO&#x7EBF;&#x7A0B;&#xFF0C;&#x5173;&#x95ED;SQL&#x7EBF;&#x7A0B;&#xFF09;</p>
<p>&#x5173;&#x95ED;IO_THREAD &#x6216;&#x8005; SQL_THREAD</p>
<pre><code>&#x4EC5;&#x4EC5;&#x8BFB;&#x7684;&#x8BF7;&#x6C42;&#x3002;&#x4ED6;&#x7684;&#x6570;&#x636E;&#x66F4;&#x65B0;&#x90FD;&#x662F;&#x6839;&#x636E;&#x4ECE;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x83B7;&#x5F97;&#x4FE1;&#x606F;&#x8FDB;&#x884C;&#x66F4;&#x65B0;&#x3002;&#x5B83;&#x4F1A;&#x6253;&#x5F00;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF1A;SQL_THREAD, IO_THREAD&#x3002;  
IO_THREAD &#x8D1F;&#x8D23;&#x8FDE;&#x63A5;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x628A;&#x76F8;&#x5173;&#x66F4;&#x65B0;&#x4E0B;&#x8F7D;&#x56DE;&#x6765;   
SQL_THREAD &#x6267;&#x884C;&#x4E0B;&#x8F7D;&#x56DE;&#x6765;&#x7684;&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x3002;
</code></pre><h3 id="binlog&#x65E5;&#x5FD7;&#x6570;&#x636E;&#x7684;&#x8FD8;&#x539F;">bin-log&#x65E5;&#x5FD7;(&#x6570;&#x636E;&#x7684;&#x8FD8;&#x539F;)</h3>
<pre><code>1&#xFF09;&#x4F7F;&#x7528;mysqlbinlog&#x81EA;&#x5E26;&#x67E5;&#x770B;&#x547D;&#x4EE4;&#x6CD5;&#xFF1A;
&#x6CE8;&#x610F;&#xFF1A;
--&gt;binlog&#x662F;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#xFF0C;&#x666E;&#x901A;&#x6587;&#x4EF6;&#x67E5;&#x770B;&#x5668;cat&#x3001;more&#x3001;vim&#x7B49;&#x90FD;&#x65E0;&#x6CD5;&#x6253;&#x5F00;&#xFF0C;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x81EA;&#x5E26;&#x7684;mysqlbinlog&#x547D;&#x4EE4;&#x67E5;&#x770B;
--&gt;binlog&#x65E5;&#x5FD7;&#x4E0E;&#x6570;&#x636E;&#x5E93;&#x6587;&#x4EF6;&#x5728;&#x540C;&#x76EE;&#x5F55;&#x4E2D;
--&gt;&#x5728;MySQL5.5&#x4EE5;&#x4E0B;&#x7248;&#x672C;&#x4F7F;&#x7528;mysqlbinlog&#x547D;&#x4EE4;&#x65F6;&#x5982;&#x679C;&#x62A5;&#x9519;&#xFF0C;&#x5C31;&#x52A0;&#x4E0A; &#x201C;--no-defaults&#x201D;&#x9009;&#x9879;

[root@vagrant-centos65 mysql]# ps axu |grep mysql
root      1410  0.2  0.2 106088  1488 pts/0    S    07:14   0:00 /bin/sh /usr/bin/mysqld_safe --datadir=/var/lib/mysql --socket=/var/lib/mysql/mysql.sock --pid-file=/var/run/mysqld/mysqld.pid --basedir=/usr --user=mysql
mysql     1518  3.7  3.2 396240 19816 pts/0    Sl   07:14   0:00 /usr/libexec/mysqld --basedir=/usr --datadir=/var/lib/mysql --user=mysql --log-error=/var/log/mysqld.log --pid-file=/var/run/mysqld/mysqld.pid --socket=/var/lib/mysql/mysql.sock
</code></pre><p>&#x627E;&#x5230; --datadir&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x540E;&#x9762;&#x7684;&#x76EE;&#x5F55;&#x5C31;&#x662F;mysql&#x7684;&#x6570;&#x636E;&#x76EE;&#x5F55;
&#x53EF;&#x4EE5;&#x627E;&#x5230;bin-log&#x65E5;&#x5FD7;</p>
<p>&#x67E5;&#x770B;bin-log&#x65E5;&#x5FD7;&#x7684;&#x65B9;&#x6CD5;</p>
<pre><code>mysqlbinlog mysql-bin.000001
[root@vagrant-centos65 mysql]# mysqlbinlog mysql-bin.000001 
/*!40019 SET @@session.max_insert_delayed_threads=0*/;
/*!50003 SET @OLD_COMPLETION_TYPE=@@COMPLETION_TYPE,COMPLETION_TYPE=0*/;
DELIMITER /*!*/;
# at 4
#170619  7:21:27 server id 1  end_log_pos 106   Start: binlog v 4, server v 5.1.73-log created 170619  7:21:27 at startup
# Warning: this binlog is either in use or was not closed properly.
ROLLBACK/*!*/;
BINLOG &apos;
d3tHWQ8BAAAAZgAAAGoAAAABAAQANS4xLjczLWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAB3e0dZEzgNAAgAEgAEBAQEEgAAUwAEGggAAAAICAgC
&apos;/*!*/;
# at 106
#170619  7:38:00 server id 1  end_log_pos 244   Query   thread_id=3     exec_time=0     error_code=0
SET TIMESTAMP=1497857880/*!*/;
SET @@session.pseudo_thread_id=3/*!*/;
SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=1, @@session.unique_checks=1, @@session.autocommit=1/*!*/;
SET @@session.sql_mode=0/*!*/;
SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;
/*!\C latin1 *//*!*/;
SET @@session.character_set_client=8,@@session.collation_connection=8,@@session.collation_server=8/*!*/;
SET @@session.lc_time_names=0/*!*/;
SET @@session.collation_database=DEFAULT/*!*/;
SET PASSWORD FOR &apos;root&apos;@&apos;localhost&apos;=&apos;*22DF0FE262826C66C3A1E8BC8DC2AF2259B42F46&apos;
</code></pre><p>&#x89E3;&#x91CA;
server id 1 &#xFF1A; &#x6570;&#x636E;&#x5E93;&#x4E3B;&#x673A;&#x7684;&#x670D;&#x52A1;&#x53F7;&#xFF1B;
end_log_pos 796&#xFF1A; sql&#x7ED3;&#x675F;&#x65F6;&#x7684;pos&#x8282;&#x70B9;
thread_id=11&#xFF1A; &#x7EBF;&#x7A0B;&#x53F7;</p>
<p>&#x65B9;&#x6CD5;2 &#x4E0A;&#x9762;&#x8FD9;&#x79CD;&#x529E;&#x6CD5;&#x8BFB;&#x53D6;&#x51FA;binlog&#x65E5;&#x5FD7;&#x7684;&#x5168;&#x6587;&#x5185;&#x5BB9;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x4E0D;&#x5BB9;&#x6613;&#x5206;&#x8FA8;&#x67E5;&#x770B;&#x5230;pos&#x70B9;&#x4FE1;&#x606F;
&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x4E00;&#x79CD;&#x66F4;&#x4E3A;&#x65B9;&#x4FBF;&#x7684;&#x67E5;&#x8BE2;&#x547D;&#x4EE4;&#xFF1A;
&#x547D;&#x4EE4;&#x683C;&#x5F0F;&#xFF1A;</p>
<pre><code>mysql&gt; show binlog events [IN &apos;log_name&apos;] [FROM pos] [LIMIT [offset,] row_count];
&#x53C2;&#x6570;&#x89E3;&#x91CA;&#xFF1A;
IN &apos;log_name&apos; &#xFF1A;&#x6307;&#x5B9A;&#x8981;&#x67E5;&#x8BE2;&#x7684;binlog&#x6587;&#x4EF6;&#x540D;(&#x4E0D;&#x6307;&#x5B9A;&#x5C31;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;binlog&#x6587;&#x4EF6;)
FROM pos &#xFF1A;&#x6307;&#x5B9A;&#x4ECE;&#x54EA;&#x4E2A;pos&#x8D77;&#x59CB;&#x70B9;&#x5F00;&#x59CB;&#x67E5;&#x8D77;(&#x4E0D;&#x6307;&#x5B9A;&#x5C31;&#x662F;&#x4ECE;&#x6574;&#x4E2A;&#x6587;&#x4EF6;&#x9996;&#x4E2A;pos&#x70B9;&#x5F00;&#x59CB;&#x7B97;)
LIMIT [offset,] &#xFF1A;&#x504F;&#x79FB;&#x91CF;(&#x4E0D;&#x6307;&#x5B9A;&#x5C31;&#x662F;0)
row_count &#xFF1A;&#x67E5;&#x8BE2;&#x603B;&#x6761;&#x6570;(&#x4E0D;&#x6307;&#x5B9A;&#x5C31;&#x662F;&#x6240;&#x6709;&#x884C;)
mysql&gt; show master logs;
+------------------+-----------+
| Log_name         | File_size |
+------------------+-----------+
| mysql-bin.000001 |       695 |
| mysql-bin.000002 |       106 |
+------------------+-----------+
</code></pre><p>&#x4E3E;&#x4F8B;</p>
<pre><code>mysql&gt;  show binlog events in &apos;mysql-bin.000001&apos;\G;
*************************** 1. row ***************************
   Log_name: mysql-bin.000001
        Pos: 4
 Event_type: Format_desc
  Server_id: 1
End_log_pos: 106
       Info: Server ver: 5.1.73-log, Binlog ver: 4
*************************** 2. row ***************************
   Log_name: mysql-bin.000001
        Pos: 106
 Event_type: Query
  Server_id: 1
End_log_pos: 244
       Info: SET PASSWORD FOR &apos;root&apos;@&apos;localhost&apos;=&apos;*22DF0FE262826C66C3A1E8BC8DC2AF2259B42F46&apos;
*************************** 3. row ***************************
   Log_name: mysql-bin.000001
        Pos: 244
 Event_type: Query
  Server_id: 1
End_log_pos: 359
       Info: CREATE USER &apos;slave&apos;@&apos;172.16.147.%&apos; IDENTIFIED BY &apos;slave&apos;
*************************** 4. row ***************************
   Log_name: mysql-bin.000001
        Pos: 359
 Event_type: Query
  Server_id: 1
End_log_pos: 510
       Info: GRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO &apos;slave&apos;@&apos;172.16.147.%&apos;
*************************** 5. row ***************************
   Log_name: mysql-bin.000001
        Pos: 510
 Event_type: Query
  Server_id: 1
End_log_pos: 585
       Info: flush privileges
*************************** 6. row ***************************
   Log_name: mysql-bin.000001
        Pos: 585
 Event_type: Query
  Server_id: 1
End_log_pos: 695
       Info: create database tanzhouawen charset utf8
6 rows in set (0.00 sec)
</code></pre><p>&#x8865;&#x5145;</p>
<pre><code>&#x4E0A;&#x9762;&#x8FD9;&#x6761;&#x8BED;&#x53E5;&#x53EF;&#x4EE5;&#x5C06;&#x6307;&#x5B9A;&#x7684;binlog&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#xFF0C;&#x5206;&#x6210;&#x6709;&#x6548;&#x4E8B;&#x4EF6;&#x884C;&#x7684;&#x65B9;&#x5F0F;&#x8FD4;&#x56DE;&#xFF0C;&#x5E76;&#x53EF;&#x4F7F;&#x7528;limit&#x6307;&#x5B9A;pos&#x70B9;&#x7684;&#x8D77;&#x59CB;&#x504F;&#x79FB;&#xFF0C;&#x67E5;&#x8BE2;&#x6761;&#x6570;&#xFF01;
&#x5982;&#x4E0B;&#x64CD;&#x4F5C;&#x793A;&#x4F8B;&#xFF1A;
a&#xFF09;&#x67E5;&#x8BE2;&#x7B2C;&#x4E00;&#x4E2A;(&#x6700;&#x65E9;)&#x7684;binlog&#x65E5;&#x5FD7;&#xFF1A;
mysql&gt; show binlog events\G;

b&#xFF09;&#x6307;&#x5B9A;&#x67E5;&#x8BE2; mysql-bin.000002&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF1A;
mysql&gt; show binlog events in &apos;mysql-bin.000002&apos;\G;

c&#xFF09;&#x6307;&#x5B9A;&#x67E5;&#x8BE2; mysql-bin.000002&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x4ECE;pos&#x70B9;:624&#x5F00;&#x59CB;&#x67E5;&#x8D77;&#xFF1A;
mysql&gt; show binlog events in &apos;mysql-bin.000002&apos; from 624\G;

d&#xFF09;&#x6307;&#x5B9A;&#x67E5;&#x8BE2; mysql-bin.000002&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x4ECE;pos&#x70B9;:624&#x5F00;&#x59CB;&#x67E5;&#x8D77;&#xFF0C;&#x67E5;&#x8BE2;10&#x6761;&#xFF08;&#x5373;10&#x6761;&#x8BED;&#x53E5;&#xFF09;
mysql&gt; show binlog events in &apos;mysql-bin.000002&apos; from 624 limit 10\G;

e&#xFF09;&#x6307;&#x5B9A;&#x67E5;&#x8BE2; mysql-bin.000002&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x4ECE;pos&#x70B9;:624&#x5F00;&#x59CB;&#x67E5;&#x8D77;&#xFF0C;&#x504F;&#x79FB;2&#x884C;&#xFF08;&#x5373;&#x4E2D;&#x95F4;&#x8DF3;&#x8FC7;2&#x4E2A;&#xFF09;&#xFF0C;&#x67E5;&#x8BE2;10&#x6761;
mysql&gt; show binlog events in &apos;mysql-bin.000002&apos; from 624 limit 2,10\G;
</code></pre><h3 id="&#x5229;&#x7528;binlog&#x65E5;&#x5FD7;&#x6062;&#x590D;mysql&#x6570;&#x636E;">&#x5229;&#x7528;binlog&#x65E5;&#x5FD7;&#x6062;&#x590D;mysql&#x6570;&#x636E;</h3>
<p>&#x573A;&#x666F;&#x6A21;&#x62DF;</p>
<ul>
<li>&#x7B2C;&#x4E00;&#x6B65; wiki&#x5E93;&#x6BCF;&#x5929;&#x90FD;&#x4F1A;&#x5907;&#x4EFD;&#x4E00;&#x6B21;
```
0 4 <em> </em> * /usr/bin/mysqldump -uroot -p -B -F -R -x --master-data=2 wiki|gzip &gt;/opt/backup/wiki_$(date +%F).sql.gz
&#x53C2;&#x6570;&#x8BF4;&#x660E;&#xFF1A;
-B&#xFF1A;&#x6307;&#x5B9A;&#x6570;&#x636E;&#x5E93;
-F&#xFF1A;&#x5237;&#x65B0;&#x65E5;&#x5FD7;
-R&#xFF1A;&#x5907;&#x4EFD;&#x5B58;&#x50A8;&#x8FC7;&#x7A0B;&#x7B49;
-x&#xFF1A;&#x9501;&#x8868;
--master-data&#xFF1A;&#x5728;&#x5907;&#x4EFD;&#x8BED;&#x53E5;&#x91CC;&#x6DFB;&#x52A0;CHANGE MASTER&#x8BED;&#x53E5;&#x4EE5;&#x53CA;binlog&#x6587;&#x4EF6;&#x53CA;&#x4F4D;&#x7F6E;&#x70B9;&#x4FE1;&#x606F;
&#x7531;&#x4E8E;&#x4E0A;&#x9762;&#x5728;&#x5168;&#x5907;&#x4EFD;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x4E86;-F&#x9009;&#x9879;&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x6570;&#x636E;&#x5907;&#x4EFD;&#x64CD;&#x4F5C;&#x521A;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x5019;&#x7CFB;&#x7EDF;&#x5C31;&#x4F1A;&#x81EA;&#x52A8;&#x5237;&#x65B0;log&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4F1A;&#x81EA;&#x52A8;&#x4EA7;&#x751F;
&#x4E00;&#x4E2A;&#x65B0;&#x7684;binlog&#x65E5;&#x5FD7;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B0;&#x7684;binlog&#x65E5;&#x5FD7;&#x5C31;&#x4F1A;&#x7528;&#x6765;&#x8BB0;&#x5F55;&#x5907;&#x4EFD;&#x4E4B;&#x540E;&#x7684;&#x6570;&#x636E;&#x5E93;&#x201C;&#x589E;&#x5220;&#x6539;&#x201D;&#x64CD;&#x4F5C;.</li>
</ul>
<p>&#x67E5;&#x770B;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre><code>mysql&gt; show master status;
+------------------+----------+--------------+------------------+
| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |
+------------------+----------+--------------+------------------+
| mysql-bin.000003 |      202 |              |                  |
+------------------+----------+--------------+------------------+
1 row in set (0.00 sec)
</code></pre><p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C; mysql-bin.000003 &#x662F;&#x7528;&#x6765;&#x8BB0;&#x5F55;4:00&#x4E4B;&#x540E;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6240;&#x6709;&#x201C;&#x589E;&#x5220;&#x6539;&#x201D;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#x6B65;&#x6211;&#x4EEC;&#x5BF9;&#x8FD9;&#x4E2A;&#x5E93;&#x8FDB;&#x884C;&#x4E86;&#x5404;&#x79CD;&#x64CD;&#x4F5C;(&#x65E9;&#x4E0A;9&#x70B9;)
&#x6211;&#x4EEC;&#x63D2;&#x5165;&#x4E00;&#x6761;&#x6570;&#x636E;</p>
<pre><code>mysql&gt; insert into wiki_user(`username`,`password`,`email`)values(&apos;tanzhouawen&apos;,&apos;123456&apos;,&apos;123123@qq.com&apos;)
    -&gt; ;
Query OK, 1 row affected, 1 warning (0.00 sec)
</code></pre><p>&#x7B2C;&#x4E09;&#x6B65; &#x4E0B;&#x5348;18:00 &#x60B2;&#x5267;&#x4E86; &#x6211;&#x628A;&#x6570;&#x636E;&#x7ED9;&#x5220;&#x6389;&#x4E86;</p>
<pre><code>mysql&gt; drop database wiki;
Query OK, 48 rows affected (0.00 sec)
</code></pre><p>&#x7B2C;&#x56DB;&#x6B65; &#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5927;&#x5BB6;&#x4E00;&#x5B9A;&#x4E0D;&#x8981;&#x614C;&#x5F20;
&#x5148;&#x4ED4;&#x7EC6;&#x67E5;&#x770B;&#x6700;&#x540E;&#x4E00;&#x4E2A;binlog &#x65E5;&#x5FD7; &#x5E76;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;&#x5173;&#x952E;&#x7684;pos&#x70B9; &#x770B;&#x770B;&#x662F;&#x54EA;&#x4E00;&#x4E2A;pos&#x70B9;&#x5BFC;&#x81F4;&#x4E86;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7834;&#x574F;</p>
<ol>
<li>&#x5148;&#x505C;&#x6389;&#x4E1A;&#x52A1; &#x4E0D;&#x80FD;&#x518D;&#x63D2;&#x5165;&#x6570;&#x636E;&#x5E93;&#x3002;&#x5982;&#x679C;&#x662F;java&#x540E;&#x7AEF; &#x9700;&#x8981;&#x628A;java&#x505C;&#x6389;</li>
<li>&#x5907;&#x4EFD;&#x6700;&#x540E;&#x4E00;&#x4E2A;binlog&#x65E5;&#x5FD7;<pre><code>[root@vagrant-centos65 mysql]# cd /var/lib/mysql/
[root@vagrant-centos65 mysql]# cp mysql-bin.000003  /opt/backup/
[root@vagrant-centos65 mysql]# cp -v mysql-bin.000003  /opt/backup/
cp: overwrite `/opt/backup/mysql-bin.000003&apos;? y
`mysql-bin.000003&apos; -&gt; `/opt/backup/mysql-bin.000003&apos;
[root@vagrant-centos65 mysql]#
</code></pre>&#x6267;&#x884C;&#x5237;&#x65B0;&#x65E5;&#x5FD7;&#x7D22;&#x5F15;&#x7684;&#x64CD;&#x4F5C; &#x6211;&#x4EEC;&#x91CD;&#x65B0;&#x5F00;&#x59CB;&#x65B0;&#x7684;binlog&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x6587;&#x4EF6; &#x4E00;&#x822C;&#x6765;&#x8BF4;bin-log3&#x4E0D;&#x4F1A;&#x63D2;&#x5165;&#x6570;&#x636E;&#x4E86;&#x7684; &#x4F46;&#x662F;&#x4FBF;&#x4E8E;&#x6211;&#x4EEC;&#x5206;&#x6790;&#x548C;&#x627E;&#x8282;&#x70B9;&#xFF0C;&#x4EE5;&#x540E;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x64CD;&#x4F5C;&#x90FD;&#x4F1A;&#x5199;&#x5165;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;
```
mysql&gt; flush logs;
Query OK, 0 rows affected (0.01 sec)</li>
</ol>
<p>mysql&gt; show master status;
+------------------+----------+--------------+------------------+
| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |
+------------------+----------+--------------+------------------+
| mysql-bin.000004 |      106 |              |                  |
+------------------+----------+--------------+------------------+
1 row in set (0.00 sec)</p>
<pre><code>&#x7B2C;&#x4E94;&#x6B65; &#x8BFB;&#x53D6;binlog&#x65E5;&#x5FD7;&#xFF0C;&#x5206;&#x6790;&#x95EE;&#x9898;
&#x67E5;&#x770B;binlog&#x65E5;&#x5FD7;&#x4EE5;&#x53CA;&#x8BF4;&#x8FC7;&#x4E86; &#x6211;&#x4EEC;&#x7528;&#x7B2C;&#x4E8C;&#x79CD;&#x529E;&#x6CD5;&#x67E5;&#x770B;
</code></pre><p>mysql&gt; show binlog events in &apos;mysql-bin.000003&apos;;
+------------------+-----+-------------+-----------+-------------+----------------------------------------------------------------------------------------------------------------+
| Log_name         | Pos | Event_type  | Server_id | End_log_pos | Info                                                                                                           |
+------------------+-----+-------------+-----------+-------------+----------------------------------------------------------------------------------------------------------------+
| mysql-bin.000003 |   4 | Format_desc |         1 |         106 | Server ver: 5.1.73-log, Binlog ver: 4                                                                          |
| mysql-bin.000003 | 106 | Query       |         1 |         202 | use <code>wiki</code>; DELETE FROM <code>wiki</code>.<code>wiki_session</code>                                                                  |
| mysql-bin.000003 | 202 | Intvar      |         1 |         230 | INSERT_ID=2                                                                                                    |
| mysql-bin.000003 | 230 | Query       |         1 |         391 | use <code>wiki</code>; insert into wiki_user(<code>username</code>,<code>password</code>,<code>email</code>)values(&apos;tanzhouawen&apos;,&apos;123456&apos;,&apos;123123@qq.com&apos;) |
| mysql-bin.000003 | 391 | Query       |         1 |         472 | drop database wiki                                                                                             |
| mysql-bin.000003 | 472 | Rotate      |         1 |         515 | mysql-bin.000004;pos=4                                                                                         |
+------------------+-----+-------------+-----------+-------------+----------------------------------------------------------------------------------------------------------------+
6 rows in set (0.00 sec)</p>
<pre><code>&#x5F88;&#x660E;&#x663E;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6709;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;drop database wiki
&#x5206;&#x6790;&#x5F97;&#x51FA;&#x7ED3;&#x679C; &#x5BF9;&#x6570;&#x636E;&#x5E93;&#x9020;&#x6210;&#x5F71;&#x54CD;&#x7684;pos&#x70B9;&#x5728;&#x4E8E; 230-472&#x4E4B;&#x95F4;

&#x7B2C;&#x516D;&#x6B65; &#x5148;&#x628A;&#x51CC;&#x6668;4&#x70B9;&#x5168;&#x5907;&#x4EFD;&#x7684;&#x6570;&#x636E;&#x6062;&#x590D;
</code></pre><p>[root@vagrant-centos65 backup]# cd /opt/backup/
[root@vagrant-centos65 backup]# gzip -d wiki_2017-06-21.sql.gz 
[root@vagrant-centos65 backup]# mysql -uroot -p&apos;tanzhouawen&apos; -v  &lt; wiki_2017-06-21.sql </p>
<pre><code>
&#x767B;&#x5F55;&#x6570;&#x636E;&#x5E93; &#x67E5;&#x770B;&#x6570;&#x636E;
</code></pre><p>[root@vagrant-centos65 backup]# mysql -uroot -p&apos;tanzhouawen&apos;
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 32
Server version: 5.1.73-log Source distribution</p>
<p>Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.</p>
<p>Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.</p>
<p>Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</p>
<p>mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| tanzhouawen        |
| test               |
| wiki               |
+--------------------+
5 rows in set (0.00 sec)</p>
<pre><code>&#x53EF;&#x4EE5;&#x770B;&#x5230;wiki&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x5DF2;&#x7ECF;&#x56DE;&#x6765;&#x4E86;
&#x4F46;&#x662F;&#x8FD9;&#x7D27;&#x7D27;&#x53EA;&#x662F;&#x6062;&#x590D;&#x4E86;&#x5F53;&#x5929;&#x51CC;&#x6668;4&#x70B9;&#x4E4B;&#x524D;&#x7684;&#x6570;&#x636E;&#xFF0C; &#x5728;4:00-18:00&#x7684;&#x6570;&#x636E;&#x8FD8;&#x6CA1;&#x6709;&#x6062;&#x590D;&#x56DE;&#x6765;
&#x600E;&#x4E48;&#x529E;
&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x4E4B;&#x524D;&#x7684;mysql-bin.0000003&#x7684;&#x65B0;binlog&#x65E5;&#x5FD7;&#x8FDB;&#x884C;&#x6062;&#x590D;

&#x7B2C;&#x4E03;&#x6B65; &#x4ECE;binlog&#x65E5;&#x5FD7;&#x6062;&#x590D;&#x6570;&#x636E;
&#x6062;&#x590D;&#x547D;&#x4EE4;&#x7684;&#x8BED;&#x6CD5;&#x683C;&#x5F0F;:
```mysqlbinlog mysql-bin.0000xx | mysql -u&#x7528;&#x6237;&#x540D; -p&#x5BC6;&#x7801; &#x6570;&#x636E;&#x5E93;&#x540D;
</code></pre><p>&#x5E38;&#x7528;&#x53C2;&#x6570;&#x9009;&#x9879;&#x89E3;&#x91CA;&#xFF1A;</p>
<pre><code>--start-position=875 &#x8D77;&#x59CB;pos&#x70B9;
--stop-position=954 &#x7ED3;&#x675F;pos&#x70B9;
--start-datetime=&quot;2016-9-25 22:01:08&quot; &#x8D77;&#x59CB;&#x65F6;&#x95F4;&#x70B9;
--stop-datetime=&quot;2019-9-25 22:09:46&quot; &#x7ED3;&#x675F;&#x65F6;&#x95F4;&#x70B9;
--database=zyyshop &#x6307;&#x5B9A;&#x53EA;&#x6062;&#x590D;zyyshop&#x6570;&#x636E;&#x5E93;(&#x4E00;&#x53F0;&#x4E3B;&#x673A;&#x4E0A;&#x5F80;&#x5F80;&#x6709;&#x591A;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x53EA;&#x9650;&#x672C;&#x5730;log&#x65E5;&#x5FD7;)
</code></pre><p>&#x4E0D;&#x5E38;&#x7528;&#x9009;&#x9879;&#xFF1A;</p>
<pre><code>-u --user=name &#x8FDE;&#x63A5;&#x5230;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x7684;&#x7528;&#x6237;&#x540D;
-p --password[=name] &#x8FDE;&#x63A5;&#x5230;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x7684;&#x5BC6;&#x7801;
-h --host=name &#x4ECE;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x4E0A;&#x83B7;&#x53D6;binlog&#x65E5;&#x5FD7;
--read-from-remote-server &#x4ECE;&#x67D0;&#x4E2A;MySQL&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x8BFB;&#x53D6;binlog&#x65E5;&#x5FD7;
</code></pre><p>&#x5C0F;&#x7ED3;&#xFF1A;&#x5B9E;&#x9645;&#x662F;&#x5C06;&#x8BFB;&#x51FA;&#x7684;binlog&#x65E5;&#x5FD7;&#x5185;&#x5BB9;&#xFF0C;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x7B26;&#x4F20;&#x9012;&#x7ED9;mysql&#x547D;&#x4EE4;&#x3002;&#x8FD9;&#x4E9B;&#x547D;&#x4EE4;&#x3001;&#x6587;&#x4EF6;&#x5C3D;&#x91CF;&#x5199;&#x6210;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#xFF1B;</p>
<p>&#x6307;&#x5B9A;&#x6062;&#x590D;pos&#x7ED3;&#x675F;&#x70B9;&#x6062;&#x590D;
--stop-position=391 pos&#x7ED3;&#x675F;&#x8282;&#x70B9;&#xFF08;&#x6309;&#x7167;&#x4E8B;&#x52A1;&#x533A;&#x95F4;&#x7B97;&#xFF0C;&#x662F;391&#xFF09;
&#x6267;&#x884C;&#x547D;&#x4EE4;</p>
<pre><code>/usr/bin/mysqlbinlog --stop-position=391 --database=wiki /var/lib/mysql/mysql-bin.000003 | /usr/bin/mysql -uroot -p&apos;awen&apos; -v wiki
</code></pre><p>&#x6062;&#x590D;&#x6210;&#x529F;</p>
<pre><code>mysql&gt;  show binlog events in &apos;mysql-bin.000003&apos;\G;
*************************** 1. row ***************************
   Log_name: mysql-bin.000003
        Pos: 4
 Event_type: Format_desc
  Server_id: 1
End_log_pos: 106
       Info: Server ver: 5.1.73-log, Binlog ver: 4
*************************** 2. row ***************************
   Log_name: mysql-bin.000003
        Pos: 106
 Event_type: Query
  Server_id: 1
End_log_pos: 202
       Info: use `wiki`; DELETE FROM `wiki`.`wiki_session`
*************************** 3. row ***************************
   Log_name: mysql-bin.000003
        Pos: 202
 Event_type: Intvar
  Server_id: 1
End_log_pos: 230
       Info: INSERT_ID=2
*************************** 4. row ***************************
   Log_name: mysql-bin.000003
        Pos: 230
 Event_type: Query
  Server_id: 1
End_log_pos: 391
       Info: use `wiki`; insert into wiki_user(`username`,`password`,`email`)values(&apos;tanzhouawen&apos;,&apos;123456&apos;,&apos;123123@qq.com&apos;)
*************************** 5. row ***************************
   Log_name: mysql-bin.000003
        Pos: 391
 Event_type: Query
  Server_id: 1
End_log_pos: 472
       Info: drop database wiki
*************************** 6. row ***************************
   Log_name: mysql-bin.000003
        Pos: 472
 Event_type: Rotate
  Server_id: 1
End_log_pos: 515
       Info: mysql-bin.000004;pos=4
6 rows in set (0.00 sec)
</code></pre><p>&#x5982;&#x679C;&#x6211;&#x53EA;&#x60F3;&#x6062;&#x590D;tanzhouawen&#x8FD9;&#x4E00;&#x6761;&#x6570;&#x636E;&#x600E;&#x4E48;&#x529E;</p>
<h2 id="&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x9700;&#x8981;&#x6062;&#x590D;&#x7684;&#x533A;&#x95F4;&#x6765;&#x5199;&#x4EE3;&#x7801;">&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x9700;&#x8981;&#x6062;&#x590D;&#x7684;&#x533A;&#x95F4;&#x6765;&#x5199;&#x4EE3;&#x7801;</h2>
<p>&#x66F4;&#x65B0; name=&apos;tanzhouawen&apos; &#x8FD9;&#x6761;&#x6570;&#x636E;&#xFF0C;&#x65E5;&#x5FD7;&#x533A;&#x95F4;&#x662F;Pos[230] --&gt; End_log_pos[391]&#xFF0C;&#x6309;&#x4E8B;&#x52A1;&#x533A;&#x95F4;&#x662F;&#xFF1A;Pos[230] --&gt; End_log_pos[391]
&#x6309;&#x7167;&#x4E8B;&#x52A1;&#x533A;&#x95F4;&#x5355;&#x72EC;&#x6062;&#x590D;</p>
<pre><code>[root@vagrant-centos65 backup]# /usr/bin/mysqlbinlog --start-position=230 --stop-position=391 --database=wiki /var/lib/mysql/mysql-bin.000003 | /usr/bin/mysql -uroot -p&apos;tanzhouawen&apos; -v wiki
</code></pre><p>&#x6269;&#x5C55; &#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x53BB;&#x627E;&#x5199;&#x8D44;&#x6599;&#x5B8C;&#x5584;&#x4E00;&#x4E0B; &#x6309;&#x65F6;&#x95F4;&#x6062;&#x590D;
&#x6269;&#x5C55;2 &#x5907;&#x4EFD;&#x65B9;&#x6848;
&#x65B9;&#x6848;1 &#x6BCF;&#x5929;&#x51CC;&#x6668;4:00&#x505A;&#x4E00;&#x6B21;&#x5168;&#x5907; &#x4F7F;&#x7528;mysqldump</p>
<p>&#x65B9;&#x6848;2 rsync&#x540C;&#x6B65;binlog&#x65E5;&#x5FD7;&#x5230;&#x5907;&#x4EFD;&#x7684;&#x673A;&#x5668; &#x5B9E;&#x73B0;&#x5907;&#x4EFD;</p>
<p>&#x6269;&#x5C55;3 mysql&#x4F7F;&#x7528;&#x6280;&#x5DE7;</p>
<pre><code>[root@vagrant-centos65 backup]# mysql --help |grep dummy
  -U, --i-am-a-dummy  Synonym for option --safe-updates, -U.
i-am-a-dummy                      FALSE
</code></pre><p>&#x5982;&#x679C;&#x5728;mysql&#x540E;&#x9762;&#x52A0;&#x4E0A;-U&#x9009;&#x9879; &#x5F53;&#x53D1;&#x51FA;&#x6CA1;&#x6709;wherer &#x6216;&#x8005;limit&#x5173;&#x952E;&#x5B57;&#x7684;update&#x6216;DELETE&#x65F6;&#xFF0C;mysql&#x7A0B;&#x5E8F;&#x5C31;&#x4F1A;&#x62D2;&#x7EDD;&#x6267;&#x884C;
&#x4E3E;&#x4F8B;</p>
<pre><code>[root@vagrant-centos65 backup]# mysql -U -uroot -p&apos;tanzhouawen&apos;
delete from wiki_user;
ERROR 1175 (HY000): You are using safe update mode and you tried to update a table without a WHERE that uses a KEY column
</code></pre><p>&#x505A;&#x6210;&#x522B;&#x540D;&#x8BA9;&#x5B9E;&#x73B0; &#x4E0D;&#x52A0;&#x6761;&#x4EF6;&#x65E0;&#x6CD5;&#x5220;&#x9664;</p>
<pre><code>[root@vagrant-centos65 backup]# alias mysql=&apos;mysql -U&apos;
rsync -vzrtopg --progress --delete /var/lib/mysql root@172.16.147.26:/tmp/
</code></pre>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./di-liu-jie-ff1a-mysql-biao-de-guan-xi.html" class="navigation navigation-prev " aria-label="Previous page: 第六节：MySQL表的关系"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./di-ba-jie-ff1a-mysqlslave-xstrabackup.html" class="navigation navigation-next " aria-label="Next page: 第八节：mysqlslave--xstrabackup"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
